<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ParQHub - Oops! Something went wrong</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        body { 
            font-family: 'Poppins', sans-serif; 
            background: linear-gradient(135deg, #0a0f1c 0%, #1a1f35 50%, #0a0f1c 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .glass {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.15);
        }
        
        .glass-strong {
            background: rgba(255, 255, 255, 0.12);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .floating-animation {
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .error-icon {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .neon-btn {
            background: linear-gradient(90deg, #3b82f6, #1d4ed8);
            color: #ffffff;
            font-weight: 600;
            border-radius: 12px;
            transition: all 0.3s ease-in-out;
            position: relative;
            overflow: hidden;
        }
        
        .neon-btn:hover {
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.6), 0 0 40px rgba(29, 78, 216, 0.4);
            transform: translateY(-2px);
        }
        
        .game-button {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 1rem;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .game-button:hover {
            background: linear-gradient(135deg, #059669, #047857);
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.5);
        }
        
        .game-button:active {
            transform: scale(0.95);
        }
        
        .game-button.clicked {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            animation: buttonPulse 0.3s ease;
        }
        
        @keyframes buttonPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .score-board {
            background: linear-gradient(135deg, #7c3aed, #5b21b6);
            border-radius: 16px;
            padding: 1.5rem;
            text-align: center;
            color: white;
            margin-bottom: 2rem;
        }
        
        .game-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            max-width: 300px;
            margin: 0 auto;
        }
        
        .slide-in {
            animation: slideIn 0.6s ease-out;
        }
        
        @keyframes slideIn {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .bounce {
            animation: bounce 1s infinite;
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }
        
        .sparkle {
            position: relative;
        }
        
        .sparkle::before {
            content: 'âœ¨';
            position: absolute;
            top: -10px;
            right: -10px;
            animation: sparkleAnimation 1s ease-in-out;
            opacity: 0;
        }
        
        .sparkle.show-sparkle::before {
            animation: sparkleShow 0.5s ease-in-out;
            opacity: 1;
        }
        
        @keyframes sparkleShow {
            0% { transform: scale(0); opacity: 0; }
            50% { transform: scale(1.2); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #f59e0b;
            z-index: 1000;
        }
        
        .error-code {
            font-family: 'Courier New', monospace;
            background: rgba(0, 0, 0, 0.5);
            padding: 1rem;
            border-radius: 8px;
            border-left: 4px solid #ef4444;
        }
    </style>
</head>
<body class="text-white flex items-center justify-center min-h-screen p-4">
    <!-- Background Animation -->
    <div class="fixed inset-0 z-0">
        <div class="absolute top-20 left-20 w-32 h-32 bg-red-500/10 rounded-full blur-xl floating-animation"></div>
        <div class="absolute bottom-20 right-20 w-40 h-40 bg-purple-500/10 rounded-full blur-xl floating-animation" style="animation-delay: 1s;"></div>
        <div class="absolute top-1/2 left-1/4 w-24 h-24 bg-orange-500/10 rounded-full blur-xl floating-animation" style="animation-delay: 2s;"></div>
    </div>

    <!-- Main Error Container -->
    <div class="glass-strong rounded-3xl max-w-4xl w-full p-8 relative z-10 slide-in">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Error Information Side -->
            <div class="text-center lg:text-left">
                <!-- Error Icon -->
                <div class="flex justify-center lg:justify-start mb-6">
                    <div class="relative">
                        <div class="w-32 h-32 bg-gradient-to-r from-red-500 to-orange-500 rounded-full flex items-center justify-center error-icon">
                            <i class="fas fa-exclamation-triangle text-white text-6xl"></i>
                        </div>
                        <div class="absolute -inset-4 bg-gradient-to-r from-red-500 to-orange-500 rounded-full blur opacity-30 animate-pulse"></div>
                    </div>
                </div>
                
                <!-- Error Message -->
                <h1 class="text-4xl font-bold mb-4 bg-gradient-to-r from-red-400 to-orange-400 bg-clip-text text-transparent">
                    Oops! Something Went Wrong
                </h1>
                
                <p class="text-xl text-gray-300 mb-6">
                    Don't worry, even the best parking systems have their moments!
                </p>
                
                <!-- Error Details -->
                <div class="error-code mb-6 text-left">
                    <div class="flex items-center gap-2 mb-2">
                        <i class="fas fa-bug text-red-400"></i>
                        <span class="font-semibold text-red-400">Error Details:</span>
                    </div>
                    <p class="text-gray-300 text-sm" th:text="${error ?: 'An unexpected error occurred while processing your request.'}">Error message</p>
                    <div class="mt-2 text-xs text-gray-500">
                        <span>Error ID: </span>
                        <span th:text="${#dates.format(#dates.createNow(), 'yyyyMMdd-HHmmss')}">20241220-143045</span>
                    </div>
                </div>
                
                <!-- Navigation Buttons -->
                <div class="flex flex-col sm:flex-row gap-4 mb-6">
                    <button onclick="goBack()" class="px-6 py-3 neon-btn flex-1">
                        <i class="fas fa-arrow-left mr-2"></i>Go Back
                    </button>
                    <a href="/user/dashboard" class="px-6 py-3 bg-gradient-to-r from-purple-500 to-purple-700 text-white rounded-lg hover:from-purple-600 hover:to-purple-800 transition flex-1 text-center">
                        <i class="fas fa-home mr-2"></i>Dashboard
                    </a>
                    <a href="/user/findparking" class="px-6 py-3 bg-gradient-to-r from-green-500 to-green-700 text-white rounded-lg hover:from-green-600 hover:to-green-800 transition flex-1 text-center">
                        <i class="fas fa-search mr-2"></i>Find Parking
                    </a>
                </div>
                
                <!-- Contact Support -->
                <div class="glass p-4 rounded-lg">
                    <div class="flex items-center justify-center gap-4 text-sm text-gray-400">
                        <div class="flex items-center gap-2">
                            <i class="fas fa-envelope text-blue-400"></i>
                            <span>support@parqhub.com</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <i class="fas fa-phone text-green-400"></i>
                            <span>+94 77 123 4567</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Fun Game Side -->
            <div class="flex flex-col items-center">
                <h2 class="text-2xl font-bold mb-4 text-center">
                    <i class="fas fa-gamepad mr-2 text-purple-400"></i>
                    While You Wait... Let's Play!
                </h2>
                
                <p class="text-gray-400 text-center mb-6">
                    Click the green buttons as fast as you can!
                </p>
                
                <!-- Score Board -->
                <div class="score-board w-full max-w-sm">
                    <div class="grid grid-cols-3 gap-4">
                        <div>
                            <div class="text-2xl font-bold" id="score">0</div>
                            <div class="text-sm opacity-80">Score</div>
                        </div>
                        <div>
                            <div class="text-2xl font-bold" id="timeLeft">30</div>
                            <div class="text-sm opacity-80">Time</div>
                        </div>
                        <div>
                            <div class="text-2xl font-bold" id="level">1</div>
                            <div class="text-sm opacity-80">Level</div>
                        </div>
                    </div>
                </div>
                
                <!-- Game Grid -->
                <div class="game-grid mb-6" id="gameGrid">
                    <button class="game-button" data-index="0">1</button>
                    <button class="game-button" data-index="1">2</button>
                    <button class="game-button" data-index="2">3</button>
                    <button class="game-button" data-index="3">4</button>
                    <button class="game-button" data-index="4">5</button>
                    <button class="game-button" data-index="5">6</button>
                    <button class="game-button" data-index="6">7</button>
                    <button class="game-button" data-index="7">8</button>
                    <button class="game-button" data-index="8">9</button>
                </div>
                
                <!-- Game Controls -->
                <div class="flex gap-4">
                    <button id="startBtn" onclick="startGame()" class="px-6 py-3 bg-gradient-to-r from-green-500 to-green-700 text-white rounded-lg hover:from-green-600 hover:to-green-800 transition">
                        <i class="fas fa-play mr-2"></i>Start Game
                    </button>
                    <button id="resetBtn" onclick="resetGame()" class="px-6 py-3 bg-gradient-to-r from-gray-500 to-gray-700 text-white rounded-lg hover:from-gray-600 hover:to-gray-800 transition">
                        <i class="fas fa-redo mr-2"></i>Reset
                    </button>
                </div>
                
                <!-- High Score -->
                <div class="mt-4 text-center">
                    <div class="text-sm text-gray-400 mb-1">High Score</div>
                    <div class="text-xl font-bold text-yellow-400" id="highScore">0</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let gameState = {
            score: 0,
            timeLeft: 30,
            level: 1,
            gameActive: false,
            targetButton: null,
            gameTimer: null,
            buttonTimer: null,
            highScore: localStorage.getItem('parqhub-high-score') || 0
        };

        const scoreEl = document.getElementById('score');
        const timeEl = document.getElementById('timeLeft');
        const levelEl = document.getElementById('level');
        const highScoreEl = document.getElementById('highScore');
        const startBtn = document.getElementById('startBtn');
        const resetBtn = document.getElementById('resetBtn');
        const gameGrid = document.getElementById('gameGrid');
        const buttons = document.querySelectorAll('.game-button');

        // Initialize high score display
        highScoreEl.textContent = gameState.highScore;

        function startGame() {
            gameState.gameActive = true;
            gameState.score = 0;
            gameState.timeLeft = 30;
            gameState.level = 1;
            
            startBtn.disabled = true;
            startBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Playing...';
            
            updateDisplay();
            spawnTarget();
            
            gameState.gameTimer = setInterval(() => {
                gameState.timeLeft--;
                timeEl.textContent = gameState.timeLeft;
                
                if (gameState.timeLeft <= 0) {
                    endGame();
                }
            }, 1000);
        }

        function endGame() {
            gameState.gameActive = false;
            clearInterval(gameState.gameTimer);
            clearTimeout(gameState.buttonTimer);
            
            // Check for high score
            if (gameState.score > gameState.highScore) {
                gameState.highScore = gameState.score;
                localStorage.setItem('parqhub-high-score', gameState.highScore);
                highScoreEl.textContent = gameState.highScore;
                
                // Celebration effect
                createConfetti();
                alert('ðŸŽ‰ New High Score! ðŸŽ‰\nScore: ' + gameState.score);
            } else {
                alert('Game Over!\nFinal Score: ' + gameState.score);
            }
            
            startBtn.disabled = false;
            startBtn.innerHTML = '<i class="fas fa-play mr-2"></i>Start Game';
            clearAllTargets();
        }

        function resetGame() {
            gameState.gameActive = false;
            gameState.score = 0;
            gameState.timeLeft = 30;
            gameState.level = 1;
            
            clearInterval(gameState.gameTimer);
            clearTimeout(gameState.buttonTimer);
            
            updateDisplay();
            clearAllTargets();
            
            startBtn.disabled = false;
            startBtn.innerHTML = '<i class="fas fa-play mr-2"></i>Start Game';
        }

        function spawnTarget() {
            if (!gameState.gameActive) return;
            
            clearAllTargets();
            
            const randomIndex = Math.floor(Math.random() * buttons.length);
            const targetButton = buttons[randomIndex];
            
            targetButton.style.background = 'linear-gradient(135deg, #10b981, #059669)';
            targetButton.style.boxShadow = '0 0 20px rgba(16, 185, 129, 0.8)';
            targetButton.classList.add('bounce');
            
            gameState.targetButton = targetButton;
            
            // Auto-spawn new target after delay (gets faster with level)
            const spawnDelay = Math.max(500, 2000 - (gameState.level * 100));
            gameState.buttonTimer = setTimeout(() => {
                if (gameState.gameActive) {
                    // Miss penalty
                    gameState.score = Math.max(0, gameState.score - 1);
                    updateDisplay();
                    spawnTarget();
                }
            }, spawnDelay);
        }

        function clearAllTargets() {
            buttons.forEach(button => {
                button.style.background = 'linear-gradient(135deg, #6b7280, #4b5563)';
                button.style.boxShadow = 'none';
                button.classList.remove('bounce', 'clicked', 'sparkle', 'show-sparkle');
            });
            gameState.targetButton = null;
        }

        function updateDisplay() {
            scoreEl.textContent = gameState.score;
            timeEl.textContent = gameState.timeLeft;
            levelEl.textContent = gameState.level;
        }

        function createConfetti() {
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * window.innerWidth + 'px';
                    confetti.style.background = ['#f59e0b', '#10b981', '#3b82f6', '#8b5cf6', '#ef4444'][Math.floor(Math.random() * 5)];
                    confetti.style.animation = 'confettiFall 3s linear forwards';
                    
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => confetti.remove(), 3000);
                }, i * 50);
            }
        }

        // Add confetti animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes confettiFall {
                0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
                100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // Button click handlers
        buttons.forEach(button => {
            button.addEventListener('click', () => {
                if (!gameState.gameActive) return;
                
                if (button === gameState.targetButton) {
                    // Correct button clicked
                    gameState.score += gameState.level;
                    button.classList.add('clicked', 'sparkle', 'show-sparkle');
                    
                    // Level up every 10 points
                    if (gameState.score % 10 === 0) {
                        gameState.level++;
                    }
                    
                    updateDisplay();
                    clearTimeout(gameState.buttonTimer);
                    
                    setTimeout(() => {
                        if (gameState.gameActive) {
                            spawnTarget();
                        }
                    }, 200);
                } else {
                    // Wrong button clicked
                    button.style.background = 'linear-gradient(135deg, #ef4444, #dc2626)';
                    setTimeout(() => {
                        if (gameState.gameActive) {
                            button.style.background = 'linear-gradient(135deg, #6b7280, #4b5563)';
                        }
                    }, 300);
                }
            });
        });

        // Go back function
        function goBack() {
            if (window.history.length > 1) {
                window.history.back();
            } else {
                window.location.href = '/user/dashboard';
            }
        }

        // Initialize game
        clearAllTargets();
    </script>
</body>
</html>